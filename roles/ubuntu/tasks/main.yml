---
- name: Install repo
  become: yes
  apt_repository:
    repo: ppa:kelleyk/emacs

- name: Install base packages
  package:
    name: "{{ item }}"
    state: latest
  become: yes
  with_items:
    - openjdk-8-jdk
    - rake
    - git
    - zsh
    - vim
    - ranger
    - emacs26
    - x11-xkb-utils
    - libssl1.0-dev
    - libffi-dev
    - libreadline-dev
    - libsqlite3-dev
    - gnupg2

- name: Install python packages
  package:
    name: "{{ item }}"
    state: latest
  become: yes
  with_items:
    - python3-pip
    - python-pip
    - python-virtualenv
    - virtualenvwrapper

- name: Add kubectl apt key
  apt_key:
    url: https://packages.cloud.google.com/apt/doc/apt-key.gpg
  become: yes

- name: Add kubectl repository
  apt_repository:
    repo: deb https://apt.kubernetes.io/ kubernetes-xenial main
    state: present
  become: yes

- name: Install kubectl
  package:
    name: kubectl
  become: yes

- name: Install python modules
  pip:
    name: "{{ item }}"
    state: latest
  become: yes
  with_items:
    - virtualenv
    - virtualenvwrapper

- name: Connect to windows daemon
  lineinfile:
    path: ~/.zshrc
    state: present
    line: "export DOCKER_HOST=tcp://localhost:2375"
